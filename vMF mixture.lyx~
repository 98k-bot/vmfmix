#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\DeclareMathOperator*{\T}{\scriptscriptstyle \top}
\title{Bayesian vMF mixture model}
\author{Shaohua Li\\shaohua@gmail.com\\National University of Singapore}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
maketitle
\end_layout

\end_inset


\end_layout

\begin_layout Standard
We adopt a simplification of the Bayesian vMF mixture model proposed in
 
\begin_inset CommandInset citation
LatexCommand cite
key "vmfmix"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
This model reappears in 
\begin_inset CommandInset citation
LatexCommand cite
key "vmftopic"

\end_inset

 under the name 
\begin_inset Quotes eld
\end_inset

mix-vMF topic model
\begin_inset Quotes erd
\end_inset

.
 But the inference scheme in 
\begin_inset CommandInset citation
LatexCommand cite
key "vmftopic"

\end_inset

 is sampling-based, which is presumed to be less accurate than the EM algorithm
 presented here.
\end_layout

\end_inset

.
 For computational efficiency, the priors on the vMF mean 
\begin_inset Formula $\{\boldsymbol{\mu}_{k}\}$
\end_inset

 and on the vMF concentration 
\begin_inset Formula $\{\kappa_{k}\}$
\end_inset

 are removed.
 
\end_layout

\begin_layout Section
Model Specification
\end_layout

\begin_layout Standard
The generative process is as follows:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\boldsymbol{\theta}_{i}\sim\textrm{Dir}(\alpha)$
\end_inset

;
\end_layout

\begin_layout Enumerate
\begin_inset Formula $z_{ij}\sim\textrm{Cat}(\boldsymbol{\theta}_{i})$
\end_inset

;
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\boldsymbol{x}_{ij}\sim\textrm{vMF}(\boldsymbol{\mu}_{z_{ij}},\kappa_{z_{ij}})$
\end_inset

.
\end_layout

\begin_layout Standard
Here 
\begin_inset Formula $\alpha$
\end_inset

 is a hyperparameter, 
\begin_inset Formula $\{\boldsymbol{\mu}_{k},\kappa_{k}\}$
\end_inset

 are parameters of mixture components to be learned.
\end_layout

\begin_layout Section
Model Likelihood and Inference
\end_layout

\begin_layout Standard
Given parameters 
\begin_inset Formula $\{\boldsymbol{\mu}_{k},\kappa_{k}\}$
\end_inset

, the complete-data likelihood of a dataset 
\begin_inset Formula $\{\boldsymbol{X},\boldsymbol{Z},\boldsymbol{\Theta}\}=\{\boldsymbol{x}_{ij},z_{ij},\boldsymbol{\theta}_{i}\}$
\end_inset

 is:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
p(\boldsymbol{X},\boldsymbol{Z},\boldsymbol{\Theta}|\alpha,\{\boldsymbol{\mu}_{k},\kappa_{k}\})=\prod_{i}\textrm{Dir}(\boldsymbol{\theta}_{i}|\alpha)\prod_{j}\theta_{i,z_{ij}}\textrm{vMF}(\boldsymbol{x}_{ij}|\boldsymbol{\mu}_{z_{ij}},\kappa_{z_{ij}}).\label{eq:complete-like}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The incomplete-data likelihood of 
\begin_inset Formula $\{\boldsymbol{X},\boldsymbol{\Theta}\}=\{\boldsymbol{x}_{ij},\boldsymbol{\theta}_{i}\}$
\end_inset

 is obtained by integrating out the latent variables 
\begin_inset Formula $\boldsymbol{Z},\boldsymbol{\Theta}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
p(\boldsymbol{X}|\alpha,\{\boldsymbol{\mu}_{k},\kappa_{k}\})=\int d\boldsymbol{\Theta}\cdot\prod_{i}\textrm{Dir}(\boldsymbol{\theta}_{i}|\alpha)\prod_{j}\sum_{k}\theta_{ik}\textrm{vMF}(\boldsymbol{x}_{ij}|\boldsymbol{\mu}_{k},\kappa_{k}).\label{eq:incomp-like}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:incomp-like"

\end_inset

 is apparently intractable, and instead we seek its variational lower bound:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\log p(\boldsymbol{X}|\alpha,\{\boldsymbol{\mu}_{k},\kappa_{k}\}) & \ge E_{q(\boldsymbol{Z},\boldsymbol{\Theta})}[\log p(\boldsymbol{X},\boldsymbol{Z},\boldsymbol{\Theta}|\alpha,\{\boldsymbol{\mu}_{k},\kappa_{k}\})-\log q(\boldsymbol{Z},\boldsymbol{\Theta})].\nonumber \\
 & =\mathcal{L}(q,\{\boldsymbol{\mu}_{k},\kappa_{k}\})\label{eq:varlb}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
It is natural to use the following variational distribution to approximate
 the posterior distribution of 
\begin_inset Formula $\boldsymbol{Z},\boldsymbol{\Theta}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
q(\boldsymbol{Z},\boldsymbol{\Theta})=\prod_{i}\Bigl\{\textrm{Dir}(\boldsymbol{\theta}_{i}|\boldsymbol{\phi}_{i})\prod_{j}\textrm{Cat}(z_{ij}|\boldsymbol{\pi}_{ij})\Bigr\}.\label{eq:q}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Then the variational lower bound is
\begin_inset Formula 
\begin{align}
 & \mathcal{L}(q,\{\boldsymbol{\mu}_{k},\kappa_{k}\})\nonumber \\
= & C_{0}+\mathcal{H}(q)+E_{q(\boldsymbol{Z},\boldsymbol{\Theta})}\Bigl[(\alpha-1)\sum_{i,k}\log\theta_{ik}\nonumber \\
 & +\sum_{i,j,k}\delta(z_{ij}=k)(\log\theta_{ik}+\log c_{d}(\kappa_{k})+\kappa_{k}\boldsymbol{\mu}_{k}^{\T}\boldsymbol{x}_{ij})\Bigr]\nonumber \\
= & C_{0}+\mathcal{H}(q)+\sum_{i,k}(\alpha-1+n_{i\cdot k})\Bigl(\psi(\phi_{ik})-\psi(\phi_{i0})\Bigr)\nonumber \\
 & +\sum_{k}\Bigl(n_{\cdot\cdot k}\cdot\log c_{d}(\kappa_{k})+\kappa_{k}\boldsymbol{\mu}_{k}^{\T}\boldsymbol{r}_{k}\Bigr),\label{eq:varlb2}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
where
\begin_inset Formula 
\begin{align}
n_{i\cdot k} & =\sum_{j}\pi_{ijk},\quad n_{\cdot\cdot k}=\sum_{i,j}\pi_{ijk},\label{eq:n}\\
\boldsymbol{r}_{k} & =\sum_{i,j}\pi_{ijk}\cdot\boldsymbol{x}_{ij},\label{eq:rk}
\end{align}

\end_inset

and 
\begin_inset Formula $\mathcal{H}(q)$
\end_inset

 is the entropy of 
\begin_inset Formula $q(\boldsymbol{Z},\boldsymbol{\Theta})$
\end_inset

:
\begin_inset Formula 
\begin{align}
\mathcal{H}(q)= & -E_{q}[\log q(\boldsymbol{Z},\boldsymbol{\Theta})]\nonumber \\
= & \sum_{i}E_{q}\Bigl[\sum_{k}\log\Gamma(\phi_{ik})-\log\Gamma(\phi_{i0})-\sum_{k}(\phi_{ik}-1)\log\theta_{ik}\nonumber \\
 & -\sum_{j,k}\delta(z_{ij}=k)\log\pi_{ijk}\Bigr]\nonumber \\
= & \sum_{i}\Bigl(\sum_{k}\log\Gamma(\phi_{ik})-\log\Gamma(\phi_{i0})-\sum_{k}(\phi_{ik}-1)\psi(\phi_{ik})\Bigr)\nonumber \\
 & +(\phi_{i0}-K)\psi(\phi_{i0})-\sum_{j,k}\pi_{ijk}\log\pi_{ijk}.\label{eq:Hq}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
By taking the partial derivative of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:varlb2"

\end_inset

 w.r.t.
 
\begin_inset Formula $\pi_{ijk},\phi_{ik},\boldsymbol{\mu}_{k},\kappa_{k},$
\end_inset

 respectively, we can obtain the following variational EM update equations
 
\begin_inset CommandInset citation
LatexCommand cite
key "vmfclust,vmfmix,vmftopic"

\end_inset

.
\end_layout

\begin_layout Subsection
E-Step
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\pi_{ijk} & \sim e^{\psi(\phi_{ik})}\cdot\textrm{vMF}(\boldsymbol{x}_{ij}|\boldsymbol{\mu}_{k},\kappa_{k}),\nonumber \\
\phi_{ik} & =n_{i\cdot k}+\alpha.\label{eq:e-step}
\end{align}

\end_inset


\end_layout

\begin_layout Subsection
M-Step
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\boldsymbol{\mu}_{k} & =\frac{\boldsymbol{r}_{k}}{\left\Vert \boldsymbol{r}_{k}\right\Vert },\nonumber \\
\bar{r}_{k} & =\frac{\left\Vert \boldsymbol{r}_{k}\right\Vert }{n_{..k}},\nonumber \\
\kappa_{k} & \approx\frac{\bar{r}_{k}D-\bar{r}_{k}^{3}}{1-\bar{r}_{k}^{2}}.\label{eq:m-step}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The update equation of 
\begin_inset Formula $\kappa_{k}$
\end_inset

 adopts the approximation proposed in 
\begin_inset CommandInset citation
LatexCommand cite
key "vmfclust"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "vMF mixture"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
